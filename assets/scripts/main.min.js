const treeToggleEls=document.querySelectorAll(".tree-toggle");treeToggleEls.forEach((e=>{const t=e.closest("li");t.querySelectorAll("ul li").length>0?e.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation();let t=e.currentTarget.closest("li");t.classList.contains("expanded")||t.classList.contains("current")&&!t.classList.contains("collapsed")?(t.classList.remove("expanded"),t.classList.add("collapsed")):(t.classList.add("expanded"),t.classList.remove("collapsed"))})):t.classList.add("non-expandable")}));const treeLinks=document.querySelectorAll(".tree-link");for(let e=0;e<treeLinks.length;e++)if(treeLinks[e].href==document.location.href){treeLinks[e].scrollIntoView(!1);break}const toggleH=(e,t)=>{if(!t)return;const s=parseInt(t.tagName.substr(1));for(;t;)if((t=t.nextSibling)&&t.nodeType!=Node.TEXT_NODE){if(t.classList.contains("next-reading")||"FOOTER"==t.tagName)return;if(2==t.tagName.length&&"H"==t.tagName.substr(0,1)){if(parseInt(t.tagName.substr(1))<=s)return}e?t.removeAttribute("hidden"):t.setAttribute("hidden",!0)}};document.querySelectorAll("h2:not(.static), h3:not(.static)").forEach((e=>e.addEventListener("click",(e=>{let t=e.target;const s=t.classList.contains("collapsed");s?t.classList.remove("collapsed"):t.classList.add("collapsed"),toggleH(s,t)})))),document.querySelectorAll("h2, h3, h4, h5, h6").forEach((e=>{if(e.classList.contains("noanchor"))return;const t=document.createElement("a");t.href=`#${e.id}`,t.classList.add("anchor-link","alt","icon-anchor"),e.appendChild(t)})),document.querySelectorAll("img").forEach((e=>{e.complete&&0==e.naturalHeight&&(e.classList.add("broken"),e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==")}));const tocElement=document.querySelector(".toc");if(tocElement){const e=document.querySelector(".main-content"),t=tocElement.querySelectorAll("li"),s=e.querySelectorAll("h2, h3, h4, h5, h6");t.forEach((e=>{e.addEventListener("click",(e=>{t.forEach((e=>e.classList.remove("active"))),e.currentTarget.classList.add("active")}))}));const n=()=>{if(window.location.hash){const e=window.location.hash.substring(1),t=document.getElementById(e);if(t)return t}for(const e of s){const t=e.getBoundingClientRect();if(t.top>=0&&t.top<window.innerHeight)return e}return null},a=()=>{const e=n();e&&t.forEach((t=>{if(t.classList.remove("active"),e){const s=t.querySelector("a").href.split("#")[1];e.id===s&&t.classList.add("active")}}))};e.addEventListener("scroll",(()=>a())),a()}const navElement=document.querySelector(".main-nav");if(navElement){const e="nav-status";let t=JSON.parse(sessionStorage.getItem(e));t||(t={expanded:[],scroll:0}),t.expanded.forEach((e=>{let t=document.getElementById(e);t&&t.classList.add("expanded")})),t.scroll&&(navElement.scrollTop=parseInt(t.scroll,10)),window.addEventListener("beforeunload",(()=>{let t=[];navElement.querySelectorAll(".expanded").forEach((e=>t.push(e.id))),sessionStorage.setItem(e,JSON.stringify({scroll:navElement.scrollTop,expanded:t}))}))}if(navElement){const e="panels-sizes",t=300/document.body.clientWidth*100,s=[t,100-t];let n=JSON.parse(localStorage.getItem(e));n||(n=s);const a=document.querySelector(".burger");n[0]<10&&a.classList.add("collapsed");try{let t=Split([".main-nav",".main-content"],{sizes:n,minSize:[0,450],gutterSize:6,direction:"horizontal",snapOffset:70,cursor:"ew-resize",onDragEnd:function(t){localStorage.setItem(e,JSON.stringify(t))}});a.addEventListener("click",(n=>{if(n.preventDefault(),t){let n=t.getSizes()[0]<10?s:[0,100];a.classList.toggle("collapsed",n[0]<10),t.setSizes(n),localStorage.setItem(e,JSON.stringify(n))}}))}catch(e){}}class Theme{theme;ctrl;get current(){return"system"==this.theme?this.getActualTheme():this.theme}get isDark(){return"dark"==this.current}get isLight(){return"light"==this.current}constructor(){this.theme=localStorage.getItem("theme")||"system",window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>this.apply())),this.ctrl=document.querySelector(".change-theme"),this.ctrl.addEventListener("click",(e=>{e.preventDefault(),this.change("light"==this.theme?"dark":"dark"==this.theme?"system":"light")})),this.apply(this.theme)}getActualTheme(){if(!window.matchMedia)return"light";return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}change(e){localStorage.setItem("theme",e),this.apply(e)}apply(e){this.theme=e,"dark"==this.theme?document.documentElement.setAttribute("data-dark",""):document.documentElement.removeAttribute("data-dark"),"light"==this.theme?document.documentElement.setAttribute("data-light",""):document.documentElement.removeAttribute("data-light"),this.ctrl.classList.remove("icon-theme-dark","icon-theme-light","icon-theme-system"),this.ctrl.classList.add("icon-theme-"+this.theme)}}new Theme;